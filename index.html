<!DOCTYPE html>
<html>
<head>
  <title>Roblox UI Builder</title>
  <style>
    body {
      font-family: sans-serif;
      display: flex;
      gap: 20px;
      padding: 20px;
    }
    .preview {
      border: 1px solid #aaa;
      width: 500px;
      height: 400px;
      position: relative;
      background: #f4f4f4;
    }
    .ui-element {
      position: absolute;
      border: 1px solid #444;
      background-color: rgba(0, 0, 0, 0.1);
    }
    .drag-handle, .resize-handle {
      width: 16px;
      height: 16px;
      position: absolute;
      background-color: #444;
      color: white;
      font-size: 10px;
      text-align: center;
      line-height: 16px;
      cursor: pointer;
    }
    .drag-handle {
      top: 0;
      left: 0;
      background: #555;
    }
    .resize-handle {
      bottom: 0;
      right: 0;
      background: #888;
      cursor: nwse-resize;
    }
    #panel {
      width: 300px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    label {
      font-weight: bold;
    }
    textarea {
      width: 100%;
      height: 200px;
    }
    #explorer {
      font-size: 14px;
      width: 180px;
      border: 1px solid #ccc;
      height: 400px;
      overflow-y: auto;
      background: #fff;
      padding: 5px;
    }
    .explorer-item {
      padding: 3px;
      cursor: pointer;
    }
    .explorer-item:hover {
      background: #eee;
    }
    .selected {
      outline: 2px solid red;
    }
  </style>
</head>
<body>

<div>
  <h2>Roblox UI Builder</h2>
  <label>Instance Type:
    <select id="instanceType">
      <option value="Frame">Frame</option>
      <option value="TextLabel">TextLabel</option>
      <option value="TextButton">TextButton</option>
      <option value="ImageLabel">ImageLabel</option>
    </select>
  </label>
  <button onclick="addElement()">Add Element</button>
  <div class="preview" id="preview"></div>
</div>

<div id="explorer">
  <b>Explorer</b><br>
  <div id="explorerList"></div>
</div>

<div id="panel">
  <h3>Properties</h3>
  <label>Name: <input id="propName"></label>
  <label>X: <input id="propLeft" type="number"></label>
  <label>Y: <input id="propTop" type="number"></label>
  <label>Width: <input id="propWidth" type="number"></label>
  <label>Height: <input id="propHeight" type="number"></label>
  <label>BG Color (RGB): <input id="propColor" placeholder="255,255,255"></label>
  <label>Text: <input id="propText"></label>
  <label>Image URL: <input id="propImage"></label>
  <button onclick="applyProperties()">Apply</button>
  <h3>Generated Lua</h3>
  <textarea id="output"></textarea>
</div>

<script>
let elementId = 0;
let selected = null;
let currentParent = null;

function addElement() {
  const type = document.getElementById("instanceType").value;
  elementId++;

  const wrapper = document.createElement("div");
  wrapper.className = "ui-element";
  wrapper.dataset.id = elementId;
  wrapper.dataset.type = type;
  wrapper.dataset.name = `${type}${elementId}`;
  wrapper.style.left = "50px";
  wrapper.style.top = "50px";
  wrapper.style.width = "100px";
  wrapper.style.height = "50px";
  wrapper.dataset.parent = currentParent?.dataset.id || "ScreenGui";

  const drag = document.createElement("div");
  drag.className = "drag-handle";
  drag.innerText = "≡";
  wrapper.appendChild(drag);

  const resize = document.createElement("div");
  resize.className = "resize-handle";
  resize.innerText = "↘";
  wrapper.appendChild(resize);

  drag.onmousedown = (e) => startDrag(e, wrapper);
  resize.onmousedown = (e) => startResize(e, wrapper);

  wrapper.onclick = (e) => {
    e.stopPropagation();
    selected = wrapper;
    currentParent = wrapper;
    updatePropertyPanel();
    highlightSelected();
    generateCode();
  };

  (currentParent || document.getElementById("preview")).appendChild(wrapper);
  generateExplorer();
  generateCode();
}

function startDrag(e, el) {
  e.preventDefault();
  let offsetX = e.clientX - el.getBoundingClientRect().left;
  let offsetY = e.clientY - el.getBoundingClientRect().top;
  function move(ev) {
    el.style.left = (ev.clientX - offsetX - el.parentElement.getBoundingClientRect().left) + "px";
    el.style.top = (ev.clientY - offsetY - el.parentElement.getBoundingClientRect().top) + "px";
    updatePropertyPanel();
    generateCode();
  }
  function stop() {
    document.removeEventListener("mousemove", move);
    document.removeEventListener("mouseup", stop);
  }
  document.addEventListener("mousemove", move);
  document.addEventListener("mouseup", stop);
}

function startResize(e, el) {
  e.preventDefault();
  const startX = e.clientX;
  const startY = e.clientY;
  const startWidth = parseInt(el.style.width);
  const startHeight = parseInt(el.style.height);
  function resize(ev) {
    el.style.width = startWidth + (ev.clientX - startX) + "px";
    el.style.height = startHeight + (ev.clientY - startY) + "px";
    updatePropertyPanel();
    generateCode();
  }
  function stop() {
    document.removeEventListener("mousemove", resize);
    document.removeEventListener("mouseup", stop);
  }
  document.addEventListener("mousemove", resize);
  document.addEventListener("mouseup", stop);
}

function updatePropertyPanel() {
  if (!selected) return;
  document.getElementById("propName").value = selected.dataset.name;
  document.getElementById("propLeft").value = parseInt(selected.style.left);
  document.getElementById("propTop").value = parseInt(selected.style.top);
  document.getElementById("propWidth").value = parseInt(selected.style.width);
  document.getElementById("propHeight").value = parseInt(selected.style.height);
  document.getElementById("propColor").value = selected.dataset.color || "255,255,255";
  document.getElementById("propText").value = selected.dataset.text || "";
  document.getElementById("propImage").value = selected.dataset.image || "";
}

function applyProperties() {
  if (!selected) return;
  selected.dataset.name = document.getElementById("propName").value;
  selected.style.left = document.getElementById("propLeft").value + "px";
  selected.style.top = document.getElementById("propTop").value + "px";
  selected.style.width = document.getElementById("propWidth").value + "px";
  selected.style.height = document.getElementById("propHeight").value + "px";
  selected.dataset.color = document.getElementById("propColor").value;
  selected.dataset.text = document.getElementById("propText").value;
  selected.dataset.image = document.getElementById("propImage").value;
  generateCode();
  generateExplorer();
}

function highlightSelected() {
  document.querySelectorAll(".ui-element").forEach(e => e.classList.remove("selected"));
  if (selected) selected.classList.add("selected");
}

function generateCode() {
  const all = document.querySelectorAll(".ui-element");
  let codeMap = {};
  all.forEach(el => {
    const name = el.dataset.name;
    const type = el.dataset.type;
    const left = parseInt(el.style.left);
    const top = parseInt(el.style.top);
    const width = parseInt(el.style.width);
    const height = parseInt(el.style.height);
    const [r, g, b] = (el.dataset.color || "255,255,255").split(",").map(n => parseInt(n));
    const text = el.dataset.text || "";
    const image = el.dataset.image || "";
    const parent = el.dataset.parent;

    let props = `local ${name} = Instance.new("${type}")\n`;
    props += `${name}.Size = UDim2.new(0, ${width}, 0, ${height})\n`;
    props += `${name}.Position = UDim2.new(0, ${left}, 0, ${top})\n`;
    props += `${name}.BackgroundColor3 = Color3.fromRGB(${r}, ${g}, ${b})\n`;
    if (text && (type === "TextLabel" || type === "TextButton")) props += `${name}.Text = "${text}"\n`;
    if (image && type === "ImageLabel") props += `${name}.Image = "${image}"\n`;
    props += `${name}.Parent = ${parent}\n\n`;

    codeMap[name] = props;
  });

  let code = `local ScreenGui = Instance.new("ScreenGui")\n`;
  for (let name in codeMap) code += codeMap[name];
  document.getElementById("output").value = code;
}

function generateExplorer() {
  const explorer = document.getElementById("explorerList");
  explorer.innerHTML = "";
  document.querySelectorAll(".ui-element").forEach(el => {
    const item = document.createElement("div");
    item.className = "explorer-item";
    item.textContent = el.dataset.name;
    item.onclick = () => {
      selected = el;
      currentParent = el;
      updatePropertyPanel();
      highlightSelected();
      generateCode();
    };
    explorer.appendChild(item);
  });
}
</script>

</body>
</html>
